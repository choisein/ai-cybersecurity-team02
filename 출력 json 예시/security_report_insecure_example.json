{
  "initial_findings": [
    {
      "check_id": "python.django.security.injection.sql.sql-injection-using-db-cursor-execute.sql-injection-db-cursor-execute",
      "path": "insecure_example.py",
      "location": {
        "start": 8,
        "end": 17
      },
      "code": "@app.route('/users')\ndef get_users():\n    user_id = request.args.get('id')\n    \n주석:     # This is the vulnerability that Semgrep might miss initially\n    conn = sqlite3.connect('test.db')\n    cursor = conn.cursor()\n    \n주석:     # Insecure query generation\n    query = f\"SELECT * FROM users WHERE id='{user_id}'\"\n    \n    cursor.execute(query)\n    users = cursor.fetchall()\n    conn.close()",
      "comments": "    # This is the vulnerability that Semgrep might miss initially\n    # Insecure query generation",
      "attack_pattern": "'; DROP TABLE users; --",
      "security_patch": "@app.route('/users')\ndef get_users():\n    user_id = request.args.get('id')\n    \n    # This is the vulnerability that Semgrep might miss initially\n    conn = sqlite3.connect('test.db')\n    cursor = conn.cursor()\n    \n    # Insecure query generation\n    query = \"SELECT * FROM users WHERE id=?\"\n    \n    cursor.execute(query, (user_id,))\n    users = cursor.fetchall()\n    conn.close()"
    }
  ],
  "new_rules": {
    "rules": []
  },
  "additional_findings": [
    {
      "check_id": "default_rule",
      "path": "insecure_example.py",
      "location": {
        "start": 8,
        "end": 8
      },
      "code": "@app.route('/users')\ndef get_users():\n    user_id = request.args.get('id')\n    \n주석:     # This is the vulnerability that Semgrep might miss initially",
      "comments": "    # This is the vulnerability that Semgrep might miss initially",
      "attack_pattern": "'user_id=%27+OR+1%3D1--",
      "security_patch": "@app.route('/users')\ndef get_users():\n    user_id = int(request.args.get('id')) \n\n# I changed 'user_id' variable to make sure it is an integer which helps to prevent SQL injection attacks."
    }
  ]
}